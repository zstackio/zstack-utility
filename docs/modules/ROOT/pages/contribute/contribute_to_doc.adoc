= å¦‚ä½•è´¡çŒ®æ–‡æ¡£
:imagesdir: ../../images/

æœ¬èŠ‚å°†ä»‹ç»ï¼š

 * `zstack-utility` çš„æ–‡æ¡£æ¶æ„
 * é€šè¿‡ `PyCharm` ç¼–å†™æ–‡æ¡£çš„æŠ€å·§
 * é€šè¿‡ `Visual Studio Code` ç¼–å†™æ–‡æ¡£çš„æŠ€å·§
 * é€šè¿‡ `PyCharm` ç¼–å†™æ–‡æ¡£çš„æŠ€å·§

æœ¬èŠ‚ä¸ä¼šä»‹ç»ï¼š

 * AsciiDoc çš„è¯­æ³•
 * PlantUMLã€Graphvizã€Ditaa ç­‰å›¾å½¢è¯­è¨€çš„è¯­æ³•

//[frame=none]
//[grid=none]
//[%noheader]
//[cols="10,~a"]
//|===
//|âœ…| `zstack-utility` çš„æ–‡æ¡£æ¶æ„
//|âœ…| é€šè¿‡ `PyCharm` ç¼–å†™æ–‡æ¡£çš„æŠ€å·§
//|âœ…| é€šè¿‡ `Visual Studio Code` ç¼–å†™æ–‡æ¡£çš„æŠ€å·§
//|â| é€šè¿‡ `PyCharm` ç¼–å†™æ–‡æ¡£çš„æŠ€å·§
//|===
//
//æœ¬èŠ‚ä¸ä¼šä»‹ç»ï¼š
//
//[frame=none]
//[grid=none]
//[%noheader]
//[cols="10,~a"]
//|===
//|â| AsciiDoc çš„è¯­æ³•
//|â| PlantUMLã€Graphvizã€Ditaa ç­‰å›¾å½¢è¯­è¨€çš„è¯­æ³•
//|===


_å…³äº asciidoc å’Œ antora çš„æ›´å¤šå†…å®¹ï¼Œå¯ä»¥å‚è€ƒ asciidoc å’Œ antora çš„å®˜æ–¹æ–‡æ¡£ï¼Œä»¥åŠ ZStack å¼€å‘è€…æ‰‹å†Œï¼Œ_

== æ–‡æ¡£ç»“æ„

zstack-utility å½“å‰çš„æ–‡æ¡£ç»“æ„ä¸ºï¼š

[source#zstack_utility_tree, bash]
.zstack-utlity çš„æ–‡æ¡£ç›®å½•ç»“æ„
----
ğŸ“’ zstack-utility/
â””â”€â”€ğŸ“‚ docs/  <1>
    â”œâ”€â”€ğŸ“„ antora.yml  <2>
    â””â”€â”€ğŸ“‚ modules/  <3>
        â”œâ”€â”€ğŸ“‚ ROOT/  <4>
        â”‚   â”œâ”€â”€ğŸ“„ nav.adoc  <5>
        â”‚   â”œâ”€â”€ğŸ“‚ pages/  <6>
        â”‚   â”‚   â”œâ”€â”€ğŸ“„ index.adoc  <7>
        â”‚   â”‚   â””â”€â”€ğŸ“„ contribute.adoc  <8>
        â”‚   â””â”€ğŸ“‚ images  <9>
        â”‚       â””â”€â”€ğŸ“„ image1.jpg  <10>
        â”œâ”€â”€ğŸ“‚ module1/  <11>
        â”‚   â”œâ”€â”€ğŸ“„ nav.adoc  <12>
        â”‚   â”œâ”€â”€ğŸ“‚ pages/  <13>
        â”‚   â”‚   â”œâ”€â”€ğŸ“„ index.adoc <14>
        â”‚   â”‚   â””â”€â”€ğŸ“„ contribute.adoc <15>
        â”‚   â”‚   â””â”€â”€ğŸ“„ function1.adoc  <16>
        â”‚   â”‚   â””â”€â”€ğŸ“„ function2.adoc
        â”‚   â”‚   â””â”€â”€ğŸ“‚ function3/  <17>
        â”‚   â”‚       â””â”€â”€ğŸ“„ subfunction1.adoc
        â”‚   â”‚       â””â”€â”€ğŸ“„ subfunction2.adoc
        â”‚   â”œâ”€â”€ğŸ“‚ examples/  <18>
        â”‚   â”‚   â””â”€â”€ğŸ”— soft_link to code folder  <19>
        â”‚   â”‚   â””â”€â”€ğŸ“„ example1.ext
        â”‚   â””â”€â”€ğŸ“‚ images/
        â”‚       â””â”€â”€ğŸ“„ image1.jpg
        â””â”€â”€ğŸ“‚ module2
----
<1> æ–‡æ¡£çš„é¡¶çº§ç›®å½•ï¼Œä¸“é—¨åˆ›å»ºç›®å½•å°†æ–‡æ¡£å’Œä»£ç åšåŒºåˆ†ï¼Œç»“æ„æ›´åŠ æ¸…æ™°ä¸€äº›
<2> `antora.yml` ç”¨æ¥å®šä¹‰æ•´ä¸ªæ–‡æ¡£çš„ä¸»è¦æ¶æ„å’Œå±æ€§
<3> `modules` ä¸º antora å®šä¹‰çš„ç›®å½•åï¼Œä¸å¯æ›´æ”¹
<4> `ROOT` ä¸º antora å®šä¹‰çš„ç‰¹æ®Šç›®å½•åï¼Œå¯ä»¥ç†è§£ä¸ºæ•´ä¸ªæ–‡æ¡£åº“çš„æœ€é¡¶å±‚åªç”¨æ¥æ”¾ä¸æ•´ä¸ª zstack-utility é€šç”¨çš„å†…å®¹
<5> `ROOT/nav.adoc` å®šä¹‰äº† `ROOT` ç›®å½•ä¸‹æ–‡ä»¶çš„å±‚çº§å…³ç³»ï¼Œæœ€ç»ˆè¢«åº”ç”¨åˆ°ç”Ÿæˆç½‘ç«™çš„å¤–å±‚ç›®å½•ç»“æ„ä¸Š
<6> `pages` ä¸º antora ä¸€èˆ¬çº¦å®šä¿—æˆçš„ç›®å½•åï¼Œæ”¾ç½®å…·ä½“çš„æ–‡æ¡£
<7> `index.adoc` ä¸º antora ä¸€èˆ¬çº¦å®šä¿—æˆçš„â€œä»‹ç»é¡µâ€ï¼Œåœ¨æœ¬é¡¹ç›®ä¸­ç”¨æ¥ä»‹ç» `zstack-utility` çš„æ•´ä½“æ¶æ„å’Œé€šç”¨å†…å®¹
<8> `contribute.adoc` ä¸º ZStack ä¸€èˆ¬çº¦å®šä¿—æˆçš„â€œå¼€å‘æŒ‡å—â€ï¼Œå› ä¸ºåœ¨ `ROOT` ç›®å½•ä¸‹ï¼Œå› æ­¤è¿™é‡Œåªä»‹ç»å¯¹æ•´ä¸ª zstack-utility éƒ½é€šç”¨çš„å¼€å‘æŒ‡å—ï¼Œå› æ­¤ä¸åŒ…å«å„ä¸ªéå¸¸çš„å…·ä½“çš„ä¸šåŠ¡
<9> `images` ä¸º antora çº¦å®šä¿—æˆçš„æ”¾ç½®å›¾ç‰‡é™„ä»¶çš„ç›®å½•ï¼Œå›¾ç‰‡æ”¾åœ¨è¿™é‡Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å¼•ç”¨
<10> `image1.jpg` ä¸ºå­˜æ”¾çš„å›¾ç‰‡é™„ä»¶ï¼Œå¯ä»¥åœ¨æ–‡æ¡£æ­£æ–‡ä¸­å¼•ç”¨
<11> `module1` ä»£æŒ‡æ­£å¼çš„ä¸€äº›ä¸šåŠ¡æ¨¡å—ï¼Œä¾‹å¦‚ `doc/modules/zstackctl`ã€`doc/modules/zstackcli`ã€`doc/modules/kvmagent` ç­‰
<12> `module1/nav.adoc` å®šä¹‰äº† `module1` ç›®å½•ä¸‹æ–‡ä»¶çš„å±‚çº§å…³ç³»ï¼Œæœ€ç»ˆè¢«åº”ç”¨åˆ°ç”Ÿæˆç½‘ç«™çš„å¤–å±‚ç›®å½•ç»“æ„ä¸Š
<13> `module1/pages` æ”¾ç½®å’Œ `module1` ç›¸å…³çš„å…·ä½“æ–‡æ¡£
<14> `module1/index.adoc` åº”å½“æè¿° `module1` æ•´ä½“çš„è®¾è®¡ã€åŠŸèƒ½å’Œæ¶æ„ï¼Œä¾‹å¦‚ xref:zstackctl:index.adoc[]
<15> `module1/contribute.adoc` åº”å½“æè¿° `module1` æ•´ä½“çš„å¼€å‘æŒ‡å—ï¼Œä¾‹å¦‚ xref:zstackctl:contribute.adoc[]
<16> `function1.adoc` æ”¾ç½®ä¸€ä¸ªåŠŸèƒ½çš„æè¿°ï¼Œæˆ–è€…ä¸€ä¸ªä»£ç æ–‡ä»¶çš„æè¿°ï¼Œä¾‹å¦‚ xref:zstackctl:set_deployment.adoc[]
<17> å¯¹äºå¤æ‚çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ `kvmagent/ha_plugin.py` å¯ä»¥å†åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œå°†åŠŸèƒ½åšæ‹†åˆ†è¿›è¡Œæè¿°ï¼Œå› æ­¤æœ‰äº† xref:kvmagent:ha_plugin/index.adoc[]ã€xref:kvmagent:ha_plugin/sharedblock.adoc[]ã€xref:kvmagent:ha_plugin/ceph.adoc[] ä¸‰ç¯‡æ–‡æ¡£å…±åŒæè¿° ha_plugin
<18> `examples` ä¸º antora çº¦å®šä¿—æˆçš„æ”¾ç½®ä¾‹å­çš„ç›®å½•ï¼Œä¸€äº›ä»£ç ç‰‡æ®µæˆ–è€…å¯ä»¥å®Œæ•´è¿è¡Œçš„ä»£ç å¯ä»¥æ”¾åœ¨è¿™é‡Œæ–¹ä¾¿å¼•ç”¨å’Œè¯»è€…ç›´æ¥ä¸‹è½½è¿è¡Œã€‚
<19> å¯ä»¥é€šè¿‡è½¯é“¾æ¥å°†ä»£ç ç›®å½•è½¯é“¾æ¥è¿‡æ¥ï¼Œæ–¹ä¾¿ä»çœŸå®ä»£ç ä¸­è¿›è¡Œå¼•ç”¨ï¼Œä¾‹å¦‚ `docs/modules/zstackctl/examples/zstack-ctl` æŒ‡å‘äº† `../../../../zstackctl`ï¼Œè§ <<examples_softlink>>

[source#examples_softlink,bash]
.examples ä¸­çš„è½¯é“¾æ¥æŒ‡å‘åˆ°ä»£ç ç›®å½•
----
(venv) âœ  examples git:(feature/introduce-asciidoc-antora) âœ— pwd
/Users/weiwang/ZStack/zstack-utility/docs/modules/zstackctl/examples
(venv) âœ  examples git:(feature/introduce-asciidoc-antora) âœ— ls -lh
total 16
-rw-r--r--  1 weiwang  staff   148B Feb  8 15:38 collect_log_host_test.yaml
-rw-r--r--  1 weiwang  staff   162B Feb  8 15:40 collect_log_two_host.yaml
lrwxr-xr-x  1 weiwang  staff    21B Feb  9 01:09 zstack-ctl -> ../../../../zstackctl
(venv) âœ  examples git:(feature/introduce-asciidoc-antora) âœ—
----

ç»¼ä¸Šï¼Œæ•´ä¸ª doc ç›®å½•çš„å±‚çº§å…³ç³»å’Œä¾èµ–å…³ç³»å¯ä»¥æ€»ç»“ä¸º <<zstack-utility_doc>>

[plantuml#zstack-utility_doc]
.doc çš„å±‚çº§ç»“æ„å’Œä¾èµ–å…³ç³»
....
skinparam monochrome true
skinparam ranksep 20
skinparam dpi 150
skinparam arrowThickness 0.7
skinparam packageTitleAlignment left
skinparam usecaseBorderThickness 0.4
skinparam defaultFontSize 12
skinparam rectangleBorderThickness 1

  folder zstack-utility/docs {
    (antora.yml)
      folder modules/ROOT {
        (nav.adoc)
        folder pages {
          (index.adoc)
          (contribute.adoc)
        }
      }
      folder modules/module1 {
        (nav1) as "nav.adoc"
        folder pages1 as "pages" {
          (index1) as "index.adoc"
          (contri1) as "contribute.adoc"
          (func1) as "func1.adoc"
          folder func2 {
            (subfunc1)
            (subfunc2)
          }
        }
    }
  }

rectangle "repo: doc_site" {
  (antora-playbook.yml)
}

(antora-playbook.yml) --> (antora.yml)
(antora.yml) --> (nav.adoc)
(antora.yml) --> (nav1)

(nav.adoc) ..> (index.adoc)
(nav.adoc) ..> (contribute.adoc)

(nav1) ..> (index1)
(nav1) ..> (contri1)
(nav1) ..> (func1)
(nav1) ..> (subfunc1)
(nav1) ..> (subfunc2)
....

== åœ¨ PyCharm ä¸‹ç¼–å†™æ–‡æ¡£

åœ¨ xref:contribute/editor_and_ide.adoc#use_pycharm[] é‡Œæ¨èäº†ä¸¤ä¸ª PyCharm æ’ä»¶ï¼Œåˆ†åˆ«æ˜¯ `AsciiDoc` å’Œ `Diagrams.net Integration`ã€‚

å‡è®¾æ²¡æœ‰è¿™äº›æ’ä»¶ï¼Œä½ ä¹Ÿä¸€æ ·å¯ä»¥ç¼–å†™æ–‡æ¡£ï¼Œç„¶è€Œæœ‰äº†è¿™ä¸¤ä¸ªæ’ä»¶ä¹‹åï¼Œæ•ˆç‡ä¼šæ›´é«˜ï¼Œå› æ­¤å¼ºçƒˆæ¨èä½¿ç”¨ã€‚

=== AsciiDoc æ’ä»¶

PyCharm ä¸‹çš„ `AsciiDoc` æ’ä»¶ä¸ IDEA çš„ `AsciiDoc` æ˜¯å®Œå…¨ä¸€è‡´çš„ï¼ˆThanks to Jetbrainsï¼‰ï¼Œä¸»è¦ä½œç”¨æ˜¯ï¼š

[#extension_function]
.AsciiDoc Plugin çš„ä¸»è¦åŠŸèƒ½
 * å®æ—¶é¢„è§ˆæ–‡æ¡£å’Œæ£€æŸ¥è¯­æ³•é”™è¯¯ã€æä¾›è¯­æ³•æç¤º
 * æ–¹ä¾¿ç²˜è´´å›¾ç‰‡
 * æ–¹ä¾¿ç²˜è´´è¡¨æ ¼
 * å¼ºå¤§çš„è‡ªåŠ¨è¡¥å…¨å’Œæç¤º

ä¸ºäº†æ–¹ä¾¿é¢„è§ˆé€šè¿‡ `include` å¼•ç”¨çš„å†…å®¹ï¼Œæ¨èå°† `Safe mode` è®¾ç½®ä¸º `Unsafe` ï¼ˆè¿™ä¹Ÿæ˜¯æ’ä»¶çš„é»˜è®¤è¡Œä¸ºï¼‰

.PyCharm Asciidoc saffe mode é…ç½®
image::image-2022-02-11-16-32-16-692.png[]

é…ç½®å¥½ä¹‹åï¼Œä½ åº”è¯¥å¯ä»¥çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„ç•Œé¢ï¼š

.PyCharm ç¼–è¾‘ AsciiDoc çš„ç•Œé¢
image::image-2022-02-11-16-46-54-376.png[]

é™¤äº† <<extension_function>> æåˆ°çš„ä¸»è¦åŠŸèƒ½ï¼Œè¿™ä¸ªæ’ä»¶è¿˜æœ‰å¾ˆå¤šç‰¹è‰²åŠŸèƒ½ï¼š

1. ç¼–è¾‘çª—å£å’Œé¢„è§ˆçª—å£å¯ä»¥å®æ—¶ç›¸äº’å®šä½
2. å¯ä»¥å®æ—¶é¢„è§ˆå›¾ç‰‡ã€è¡¨æ ¼ã€â€œæ¸²æŸ“æ–‡æœ¬ç”Ÿæˆçš„å›¾å½¢â€ï¼ˆä¾‹å¦‚ PlantUMLã€Graphvizã€Ditaa å›¾å½¢ç­‰ï¼‰
3. å¯ä»¥åœ¨é¢„è§ˆçª—å£å®æ—¶è·³è½¬åˆ°å¼•ç”¨çš„é“¾æ¥ã€include çš„ä»£ç ç­‰
4. æ”¯æŒ antora ç‰¹å®šçš„é“¾æ¥æ–¹å¼ï¼ˆè¿™ä¸ªåŠŸèƒ½ VS Code å°šä¸æ”¯æŒï¼Œè¯¦è§ <<åœ¨ Visual Studio Codeï¼‰
5. å¯ä»¥å°†å½“å‰æ–‡æ¡£ç«‹åˆ»ç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œæˆ–è€…è¾“å‡ºä¸º HTML æ–‡æ¡£æˆ– PDF æ–‡æ¡£

å¦å¤–ï¼Œå¦‚æœä½ çš„ PyCharm ç¯å¢ƒå¯ä»¥æ–¹ä¾¿çš„è®¿é—®å›½å¤–ç½‘ç«™ï¼Œå¯ä»¥æ‰“å¼€ kroki æ¸²æŸ“ï¼Œè¿™æ ·å¯ä»¥æ”¯æŒæ¸²æŸ“æ›´å¤šçš„å›¾å½¢ç±»å‹ï¼Œä¾‹å¦‚ä¸‹é¢çš„ <<network1>> å’Œ <<network2>> å¦‚æœä¸æ‰“å¼€ kroki æ¸²æŸ“çš„è¯æ˜¯æ— æ³•åœ¨ PyCharm é¢„è§ˆçš„ï¼Œä½†ä¸å½±å“æœ€ç»ˆåœ¨ https://zstack.dev å±•ç¤ºã€‚

.æ‰“å¼€ Kroki æ¸²æŸ“
image::image-2022-02-11-17-40-42-929.png[]

æ›´è¯¦ç»†çš„ä»‹ç»å‚è€ƒè¿™ä¸ªæ’ä»¶çš„é¡¹ç›®æ–‡æ¡£ï¼ˆä¹Ÿæ˜¯ç”¨ antora æ„å»ºçš„ï¼‰ https://intellij-asciidoc-plugin.ahus1.de/

[TIP]
.å°æŠ€å·§
====
1. ä¸å¦¨è¯•è¯•ç›´æ¥åœ¨ç¼–è¾‘å™¨é‡Œè´´å›¾
2. ç¼–è¾‘å™¨å…·æœ‰åˆ›å»ºè¡¨æ ¼å’Œç²˜è´´è¡¨æ ¼çš„åŠŸèƒ½ï¼Œä¸æ”¾è¯•ä¸€è¯•
====

=== Diagrams.net Integration æ’ä»¶

å¾—ç›Šäº Ascii çš„å¼ºå¤§è¯­æ³•æ”¯æŒï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ–‡æ¡£é‡Œç›´æ¥ç”»å‡ºå„ç§å›¾å½¢ï¼Œzstack.dev åœ¨æ„å»ºç½‘ç«™æ—¶ä½¿ç”¨äº† `asciidoctor-kroki` æ’ä»¶ï¼Œå› æ­¤ kroki çš„æ‰€æœ‰å›¾å½¢éƒ½å¯ä»¥æ”¯æŒï¼Œç”šè‡³åŒ…æ‹¬æ„Ÿè§‰å¾ˆå¤æ‚çš„å›¾å½¢ï¼ˆä»¥ä¸‹çš„ <<network1>> å’Œ <<network2>> åœ¨ PyCharm ä¸­é¢„è§ˆå‡éœ€è¦æ‰“å¼€ kroki æ¸²æŸ“ï¼‰ï¼š

[nwdiag#network1]
.ç½‘ç»œæ‹“æ‰‘å›¾
....
nwdiag {
  network dmz {
    address = "210.x.x.x/24"

    web01 [address = "210.x.x.1"];
    web02 [address = "210.x.x.2"];
  }
  network internal {
    address = "172.x.x.x/24";

    web01 [address = "172.x.x.1"];
    web02 [address = "172.x.x.2"];
    db01;
    db02;
  }
}
....

[bytefield#network2]
.ç½‘ç»œæŠ¥æ–‡åè®®å®šä¹‰å›¾
....
(defattrs :bg-green {:fill "#a0ffa0"})
(defattrs :bg-yellow {:fill "#ffffa0"})
(defattrs :bg-pink {:fill "#ffb0a0"})
(defattrs :bg-cyan {:fill "#a0fafa"})
(defattrs :bg-purple {:fill "#e4b5f7"})

(defn draw-group-label-header
  "Creates a small borderless box used to draw the textual label headers
  used below the byte labels for remotedb message diagrams.
  Arguments are the number of colums to span and the text of the
  label."
  [span label]
  (draw-box (text label [:math {:font-size 12}]) {:span    span
                                                  :borders #{}
                                                  :height  14}))

(defn draw-remotedb-header
  "Generates the byte and field labels and standard header fields of a
  request or response message for the remotedb database server with
  the specified kind and args values."
  [kind args]
  (draw-column-headers)
  (draw-group-label-header 5 "start")
  (draw-group-label-header 5 "TxID")
  (draw-group-label-header 3 "type")
  (draw-group-label-header 2 "args")
  (draw-group-label-header 1 "tags")
  (next-row 18)

  (draw-box 0x11 :bg-green)
  (draw-box 0x872349ae [{:span 4} :bg-green])
  (draw-box 0x11 :bg-yellow)
  (draw-box (text "TxID" :math) [{:span 4} :bg-yellow])
  (draw-box 0x10 :bg-pink)
  (draw-box (hex-text kind 4 :bold) [{:span 2} :bg-pink])
  (draw-box 0x0f :bg-cyan)
  (draw-box (hex-text args 2 :bold) :bg-cyan)
  (draw-box 0x14 :bg-purple)

  (draw-box (text "0000000c" :hex [[:plain {:font-weight "light" :font-size 16}] " (12)"])
            [{:span 4} :bg-purple])
  (draw-box (hex-text 6 2 :bold) [:box-first :bg-purple])
  (doseq [val [6 6 3 6 6 6 6 3]]
    (draw-box (hex-text val 2 :bold) [:box-related :bg-purple]))
  (doseq [val [0 0]]
    (draw-box val [:box-related :bg-purple]))
  (draw-box 0 [:box-last :bg-purple]))

(draw-remotedb-header 0x4702 9)

(draw-box 0x11)
(draw-box 0x2104 {:span 4})
(draw-box 0x11)
(draw-box 0 {:span 4})
(draw-box 0x11)
(draw-box (text "length" [:math] [:sub 1]) {:span 4})
(draw-box 0x14)

(draw-box (text "length" [:math] [:sub 1]) {:span 4})
(draw-gap "Cue and loop point bytes")

(draw-box nil :box-below)
(draw-box 0x11)
(draw-box 0x36 {:span 4})
(draw-box 0x11)
(draw-box (text "num" [:math] [:sub "hot"]) {:span 4})
(draw-box 0x11)
(draw-box (text "num" [:math] [:sub "cue"]) {:span 4})

(draw-box 0x11)
(draw-box (text "length" [:math] [:sub 2]) {:span 4})
(draw-box 0x14)
(draw-box (text "length" [:math] [:sub 2]) {:span 4})
(draw-gap "Unknown bytes" {:min-label-columns 6})
(draw-bottom)
....

[plantuml]
.è„‘å›¾
....
@startmindmap
skinparam monochrome true
+ OS
++ Ubuntu
+++ Linux Mint
+++ Kubuntu
+++ Lubuntu
+++ KDE Neon
++ LMDE
++ SolydXK
++ SteamOS
++ Raspbian
-- Windows 95
-- Windows 98
-- Windows NT
--- Windows 8
--- Windows 10
@endmindmap
....

æ›´å¤šå¯ä»¥å‚è€ƒ https://kroki.io/examples.html

ä½†æ˜¯å¯¹äºæ¯”è¾ƒå¤æ‚çš„å›¾å½¢ï¼Œé€šè¿‡æ–‡æœ¬ç¼–å†™çš„æ–¹å¼å›ºç„¶å¥½ç»´æŠ¤ï¼Œä½†å…¶å®šä¹‰çš„ä»£ç å¤ªé•¿å¤ªå¤æ‚ï¼Œå¯èƒ½ä¹Ÿä¼šåè€Œä¸§å¤±äº†å¯ç»´æŠ¤æ€§ï¼Œè¿™ç§æ—¶å€™å¯ä»¥é€šè¿‡ `Diagrams.net Integration` æ¥ç”»å›¾å’Œç»´æŠ¤ã€‚

[TIP]
.æç¤º
====
`Diagrams.net` å°±æ˜¯æ›¾ç»çš„ `draw.io`ï¼
====

[#add_svg]
.æ·»åŠ  Diagrams.net å›¾å½¢
image::image-2022-02-11-17-58-05-689.png[]

åœ¨å¼¹å‡ºçš„çª—å£ä¸­è¾“å…¥æ–‡ä»¶åï¼Œæœ€åä»¥ `.drawio` ç»“å°¾ï¼Œæ–¹ä¾¿åˆ†è¾¨å‡ºè¿™ä¸ª SVG æ–‡ä»¶æ˜¯å¯ç¼–è¾‘çš„ï¼ˆä¹‹æ‰€ä»¥ç”¨ drawio ç»“å°¾è€Œä¸æ˜¯ diagrams ç»“å°¾ä¸ VS Code çš„é»˜è®¤è¡Œä¸ºæœ‰å…³ï¼Œè§ <<_draw_io_integration_æ’ä»¶>>ï¼‰ï¼Œç±»å‹é€‰æ‹© SVG ç±»å‹ï¼ˆé»˜è®¤é€‰æ‹©ï¼‰ã€‚

.æ³¨æ„æ–‡ä»¶åå’Œç±»å‹
image::image-2022-02-11-18-01-40-518.png[]

ä¸‹é¢å°±ä¼šåœ¨ PyCharm ä¸­å¼¹å‡ºâ€œå†…åµŒâ€çš„ diagrams.net çš„ç•Œé¢ï¼š

image::image-2022-02-11-18-04-59-517.png[]

ç„¶åå°±å¯ä»¥ç¼–è¾‘å›¾å½¢äº†ï¼Œç¼–è¾‘å®Œæˆåå¯ä»¥åœ¨æ–‡æ¡£ä¸­ç›´æ¥å¼•ç”¨ï¼Œå¼•ç”¨æ–¹æ³•ä¸æ™®é€šå›¾å½¢ä¸€æ ·ï¼Œå‚è€ƒ <<#svg_image>>ï¼Œæ¸²æŸ“æ•ˆæœè§ <<svg_render>>ã€‚Diagrams.net å¯ä»¥ç”»å¾ˆä¸°å¯Œçš„å›¾å½¢ï¼Œé‡Œé¢æ”¯æŒå¾ˆå¤šå…ƒç´ å¹¶æ”¯æŒå¤šå›¾å±‚ã€å¯ä»¥å¼•ç”¨å¤–éƒ¨å›¾ç‰‡ç­‰ç­‰

[source#svg_image,asciidoc]
.åœ¨ä»£ç ä¸­å¼•ç”¨ svg å›¾å½¢
----
images::test1.diagrams.svg[]
----

[#svg_render]
.Diagrams.net å›¾å½¢æ¸²æŸ“çš„æ•ˆæœ
image::test1.drawio.svg[]

[TIP]
====
diagrams.net æä¾›äº†å¾ˆå¤šæ¨¡æ¿ï¼Œä¸çŸ¥é“æ€ä¹ˆç”»å¥½å›¾ï¼Œå¯ä»¥è¯•ä¸€ä¸‹è¿™é‡Œçš„æ¨¡æ¿ï¼

image::image-2022-02-11-22-07-50-736.png[]

æ­¤å¤–å¯¹äº SQL è¡¨æ ¼ç±»å‹çš„å›¾å½¢ï¼ŒDiagrams.net å¯ä»¥ç›´æ¥é€šè¿‡ SQL è¯­å¥è‡ªåŠ¨ç”Ÿæˆå›¾å½¢

image::image-2022-02-11-22-11-10-974.png[]
====

== åœ¨ Visual Studio Code ä¸‹ç¼–å†™æ–‡æ¡£

åœ¨ xref:contribute/editor_and_ide.adoc#use_vscode[] é‡Œæ¨èäº†ä¸¤ä¸ª VS Code æ’ä»¶ï¼Œåˆ†åˆ«æ˜¯ `AsciiDoc` å’Œ `Draw.io Integration`ã€‚

å‡è®¾æ²¡æœ‰è¿™äº›æ’ä»¶ï¼Œä½ ä¹Ÿä¸€æ ·å¯ä»¥ç¼–å†™æ–‡æ¡£ï¼Œç„¶è€Œæœ‰äº†è¿™ä¸¤ä¸ªæ’ä»¶ä¹‹åï¼Œæ•ˆç‡ä¼šæ›´é«˜ï¼Œå› æ­¤å¼ºçƒˆæ¨èä½¿ç”¨ã€‚

=== AsciiDoc æ’ä»¶

VS Code ä¸‹çš„ `AsciiDoc` æ’ä»¶ä¸ PyCharm çš„ `AsciiDoc` ç±»ä¼¼ï¼Œä¸»è¦ä½œç”¨æ˜¯ï¼š

[#vscode_extension_function]
.VS Code AsciiDoc Plugin çš„ä¸»è¦åŠŸèƒ½
 * å®æ—¶é¢„è§ˆæ–‡æ¡£å’Œæ£€æŸ¥è¯­æ³•é”™è¯¯ã€æä¾›è¯­æ³•æç¤º
 * åŸºæœ¬çš„çš„è‡ªåŠ¨è¡¥å…¨å’Œæç¤º

ä¸ºäº†èƒ½å¤Ÿå®æ—¶é¢„è§ˆ PlantUMLã€Graphviz ç­‰å›¾å½¢ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„å›¾å½¢ï¼Œå»ºè®®æ‰“å¼€ kroki æ¸²æŸ“ï¼ˆéœ€è¦èƒ½å¤Ÿè®¿é—®å¤–éƒ¨ç½‘ç»œï¼‰ï¼š

.VS Code æ’ä»¶é…ç½®
image::image-2022-02-12-15-37-37-832.png[]

[source,json]
.settings.json
----
{
    "asciidoc.use_kroki": true,
    "asciidoc.preview.refreshInterval": 1000
}
----

å› ä¸º VS Code çš„ AsciiDoc æ’ä»¶ä¸èƒ½è‡ªåŠ¨è¯†åˆ«å‡º Antora ç›®å½•ç»“æ„ï¼Œå› æ­¤éœ€è¦åœ¨æ–‡æ¡£å¼€å¤´å¢åŠ  `:imagesdir:` çš„å±æ€§ï¼Œç±»ä¼¼äº <<images_dir>>ï¼Œå…·ä½“ç›®å½•éœ€è¦æ ¹æ®å®é™…æƒ…å†µé…ç½®ï¼š

[source#images_dir,asciidoc]
.imagesdir é…ç½®
----
= æ–‡æ¡£æ ‡é¢˜
:imagesdir: ../images
----

[CAUTION]
.ä¸€å®šè¦è®°å¾— `:imagesdir:`
====
ä¸è¦ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼å¼•ç”¨å›¾ç‰‡ï¼š

[sourcemasciidoc]
----
image::../images/xxx.png
----

è¿™ç§æ–¹å¼å›ºç„¶å¯ä»¥æ­£ç¡®çš„åœ¨ç¼–è¾‘å™¨é‡Œé¢„è§ˆï¼Œä½† antora åœ¨æ„å»ºç½‘ç«™æ—¶ä¼šæŠ¥é”™ï¼

å¦å¤–å®šä¹‰ `:imagesdir:` è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯åœ¨ Gitlab ä¸Šä¹Ÿå¯ä»¥æ­£ç¡®çš„é¢„è§ˆäº†ï¼
====

=== Draw.io Integration æ’ä»¶

å’Œ PyCharm ä¸‹çš„ <<_diagrams_net_integration_æ’ä»¶>> ä¸€æ ·ï¼ŒVS Code ä¹Ÿæä¾›äº†å¯¹åº”çš„æ’ä»¶ï¼Œå®‰è£…åå³å¯åœ¨ VS Code ä¸‹ç»˜å›¾å¹¶åœ¨æ–‡æ¡£ä¸­å¼•ç”¨ï¼š

image::image-2022-02-12-15-48-37-853.png[]

Draw.io Integration é™¤äº† <<_diagrams_net_integration_æ’ä»¶>> æè¿°è¿‡çš„åŸºç¡€åŠŸèƒ½å¤–ï¼Œè¿˜æœ‰ä¸€äº›ç¥å¥‡çš„é«˜çº§åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š

* å¤šäººå®æ—¶åä½œç¼–è¾‘
* Code Link
* åŒæ­¥æ˜¾ç¤º XML

Code Link å¯ä»¥è®©å›¾å½¢å’Œä»£ç ä¹‹é—´äº§ç”Ÿé“¾æ¥å…³ç³»ï¼Œæ”¯æŒç‚¹å‡»è·³è½¬ï¼š

image::https://github.com/hediet/vscode-drawio/raw/HEAD/docs/demo-code-link.gif[]

å¦å¤–ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®çš„æ–¹æ³•å°† `.svg` å…³è”åˆ° `Draw.io Integration` æ’ä»¶ä¸Šï¼Œå‚è€ƒ <<vscode_setting_draw>> å’Œ https://marketplace.visualstudio.com/items?itemName=hediet.vscode-drawio

[source#vscode_setting_draw,json]
.VS Code .settings.json
----
"workbench.editorAssociations": {
    "*.svg": "hediet.vscode-drawio-text",
}
----

=== Ascii Tree Generator æ’ä»¶

å¦‚æœæƒ³ç”Ÿæˆ Ascii Treeï¼Œç±»ä¼¼äº <<zstack_utility_tree>> çš„æ•ˆæœï¼Œåœ¨ Visual Studio Code ä¸Šå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ’ä»¶ï¼Œè¯¦è§ https://marketplace.visualstudio.com/items?itemName=aprilandjan.ascii-tree-generator